<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>IftarFlow â€” Cart</title>
  <link rel="stylesheet" href="styles.css"/>
</head>
<body>

<!-- NAVBAR -->
<nav class="navbar">
  <a class="nav-brand" href="dashboard.html">
    <div class="nav-logo">IF</div>
    <span class="nav-logo-text">Iftar<span>Flow</span></span>
  </a>
  <div class="nav-links">
    <a href="dashboard.html">â¬¡ Home</a>
    <a href="menu.html">ğŸ½ Menu</a>
    <a href="cart.html" class="active cart-link">
      ğŸ›’ Cart
      <span class="cart-badge" id="nav-cart-count" style="display:none">0</span>
    </a>
    <a href="status.html">ğŸ“¡ Status</a>
    <a href="profile.html">ğŸ‘¤ Profile</a>
    <a href="login.html" class="logout">â» Logout</a>
  </div>
  <div class="nav-right">
    <span class="nav-user">Signed in as <strong id="nav-user-email">â€”</strong></span>
  </div>
</nav>

<div class="page-wrap">

  <div class="page-header reveal">
    <h1 class="page-title">Your <em>Cart</em> ğŸ›’</h1>
    <p class="page-subtitle">Review your Iftar selection. Placing an order sends an authenticated request through the Order Gateway with your JWT bearer token.</p>
  </div>

  <div class="grid-2">

    <!-- CART ITEMS -->
    <div>
      <div class="section-label reveal">Selected Items</div>

      <!-- Token strip -->
      <div class="token-strip mb-2 reveal" id="cart-token-strip">
        <span class="token-strip-label">JWT</span>
        <span id="cart-token-preview" style="word-break:break-all;">Not authenticated</span>
      </div>

      <!-- Items list -->
      <div id="cart-items-container">
        <!-- Populated by JS -->
      </div>

      <!-- Empty state (shown by JS if needed) -->
      <div class="cart-empty hidden" id="cart-empty">
        <div class="cart-empty-icon">ğŸŒ™</div>
        <h3>Your cart is empty</h3>
        <p class="text-muted mt-1" style="font-size:.78rem;">Browse the Iftar menu to add items.</p>
        <a href="menu.html" class="btn btn-primary" style="margin-top:1.5rem; display:inline-flex;">Browse Menu â†’</a>
      </div>
    </div>

    <!-- ORDER SUMMARY -->
    <div>
      <div class="section-label reveal">Order Summary</div>
      <div class="cart-summary reveal">
        <div class="cart-summary-row">
          <span class="text-muted">Subtotal</span>
          <span>Tk <span id="summary-subtotal">0</span></span>
        </div>
        <div class="cart-summary-row">
          <span class="text-muted">Items</span>
          <span id="summary-count">0 items</span>
        </div>
        <div class="cart-summary-row">
          <span class="text-muted">Auth</span>
          <span class="tag tag-green" id="auth-status-tag">âš™ Checking...</span>
        </div>
        <div class="cart-summary-row">
          <span class="text-muted">Stock Status</span>
          <span class="tag tag-green">âœ“ Verified via Cache</span>
        </div>
        <div class="cart-summary-row total">
          <span>Total</span>
          <span class="price">Tk <span id="summary-total">0</span></span>
        </div>

        <div style="margin-top:1.5rem;">
          <button class="btn btn-primary btn-full" id="place-order-btn" onclick="placeOrder()" disabled>
            <span id="order-btn-text">CONFIRM ORDER â†’</span>
            <div class="spinner hidden" id="order-spinner"></div>
          </button>
          <a href="menu.html" class="btn btn-secondary btn-full" style="margin-top:.75rem; display:flex;">
            â† Continue Shopping
          </a>
        </div>

        <div style="margin-top:1.5rem; padding-top:1.5rem; border-top:1px solid var(--border);">
          <div style="font-size:.65rem; color:var(--text2); line-height:2; text-transform:uppercase; letter-spacing:.07em; margin-bottom:.75rem;">Order Flow</div>
          <div style="font-size:.7rem; color:var(--text2); line-height:2;">
            1. JWT validated by Order Gateway<br/>
            2. Cache stock check (instant reject if 0)<br/>
            3. Stock decremented with optimistic lock<br/>
            4. Kitchen Queue acknowledges in &lt;2s<br/>
            5. Notification Hub pushes status updates
          </div>
        </div>
      </div>
    </div>

  </div>
</div>

<script src="app.js"></script>
</body>
</html>